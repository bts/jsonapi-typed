<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>JsonApi.Internal.Relationships</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_JsonApi-Internal-Relationships.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/JsonApi-Internal-Relationships.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">jsonapi-typed-0.1.0.0: Type-level combinators for JSON API spec</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">JsonApi.Internal.Relationships</p></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:FetchMode">FetchMode</a><ul class="subs"><li>= <a href="#v:FetchIncluded">FetchIncluded</a></li><li>| <a href="#v:FetchRelationship">FetchRelationship</a></li></ul></li><li class="src short"><span class="keyword">class</span> <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="#t:FetchRelated">FetchRelated</a> m r nm a <span class="keyword">where</span><ul class="subs"><li><a href="#v:fetchRelated">fetchRelated</a> :: <span class="keyword">forall</span> proxy. proxy (<a href="JsonApi-Internal-Api.html#t:Rel">Rel</a> nm a) -&gt; <a href="JsonApi-Internal-Relationships.html#t:FetchMode">FetchMode</a> -&gt; r -&gt; m (<a href="JsonApi-Internal-Document.html#t:Relationship">Relationship</a>, [a])</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Include">Include</a><ul class="subs"><li>= <a href="#v:IncludeDefault">IncludeDefault</a></li><li>| <a href="#v:Include">Include</a></li><li>| <a href="#v:IncludeNot">IncludeNot</a></li><li>| <a href="#v:IncludeChildren">IncludeChildren</a> (<a href="file:///nix/store/ala24qs3vbkxq3yg37x3lf52q48rria6-unordered-containers-0.2.7.0/share/doc/x86_64-linux-ghc-7.10.3/unordered-containers-0.2.7.0/html/Data-HashMap-Strict.html#t:HashMap">HashMap</a> <a href="file:///nix/store/wcg0nmsphmn7ig1j3602jznx2lxz91id-text-1.2.2.1/share/doc/x86_64-linux-ghc-7.10.3/text-1.2.2.1/html/Data-Text.html#t:Text">Text</a> <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a>)</li></ul></li><li class="src short"><a href="#v:includesForKid">includesForKid</a> :: <a href="file:///nix/store/wcg0nmsphmn7ig1j3602jznx2lxz91id-text-1.2.2.1/share/doc/x86_64-linux-ghc-7.10.3/text-1.2.2.1/html/Data-Text.html#t:Text">Text</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Included">Included</a> = <a href="#v:Included">Included</a> {<ul class="subs"><li><a href="#v:includedIds">includedIds</a> :: !(<a href="file:///nix/store/ala24qs3vbkxq3yg37x3lf52q48rria6-unordered-containers-0.2.7.0/share/doc/x86_64-linux-ghc-7.10.3/unordered-containers-0.2.7.0/html/Data-HashSet.html#t:HashSet">HashSet</a> <a href="JsonApi-Internal-Document.html#t:ResourceId">ResourceId</a>)</li><li><a href="#v:includedObjects">includedObjects</a> :: <a href="file:///nix/store/ala24qs3vbkxq3yg37x3lf52q48rria6-unordered-containers-0.2.7.0/share/doc/x86_64-linux-ghc-7.10.3/unordered-containers-0.2.7.0/html/Data-HashMap-Strict.html#t:HashMap">HashMap</a> <a href="JsonApi-Internal-Document.html#t:ResourceType">ResourceType</a> [<a href="JsonApi-Internal-Document.html#t:ResourceObject">ResourceObject</a>]</li></ul>}</li><li class="src short"><a href="#v:emptyIncluded">emptyIncluded</a> :: <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a></li><li class="src short"><a href="#v:addIncluded">addIncluded</a> :: <a href="JsonApi-Internal-Document.html#t:ResourceObject">ResourceObject</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a></li><li class="src short"><a href="#v:foldIncluded">foldIncluded</a> :: <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Foldable.html#t:Foldable">Foldable</a> t =&gt; t <a href="JsonApi-Internal-Document.html#t:ResourceObject">ResourceObject</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a></li><li class="src short"><span class="keyword">class</span> <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="#t:FetchRelationship">FetchRelationship</a> m r a <span class="keyword">where</span><ul class="subs"><li><a href="#v:fetchRelationship">fetchRelationship</a> :: <span class="keyword">forall</span> proxy. proxy a -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a> -&gt; r -&gt; m ((<a href="file:///nix/store/wcg0nmsphmn7ig1j3602jznx2lxz91id-text-1.2.2.1/share/doc/x86_64-linux-ghc-7.10.3/text-1.2.2.1/html/Data-Text.html#t:Text">Text</a>, <a href="JsonApi-Internal-Document.html#t:Relationship">Relationship</a>), <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Monoid.html#t:Endo">Endo</a> <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a>)</li></ul></li><li class="src short"><a href="#v:doFetchRelationship">doFetchRelationship</a> :: (<a href="JsonApi-Internal-Resource.html#t:IsResource">IsResource</a> a, <a href="JsonApi-Internal-Resource.html#t:HasResourceId">HasResourceId</a> a, <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/GHC-TypeLits.html#t:KnownSymbol">KnownSymbol</a> nm, <a href="JsonApi-Internal-Relationships.html#t:FetchRelated">FetchRelated</a> m r nm a, <a href="JsonApi-Internal-Relationships.html#t:SerialiseResource">SerialiseResource</a> m (<a href="JsonApi-Internal-Api.html#t:Resource">Resource</a> a relationships)) =&gt; <span class="keyword">forall</span> proxy. proxy (<a href="JsonApi-Internal-Api.html#t:Rel">Rel</a> nm a) -&gt; proxy (<a href="JsonApi-Internal-Api.html#t:Resource">Resource</a> a relationships) -&gt; <a href="JsonApi-Internal-Relationships.html#t:FetchMode">FetchMode</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a> -&gt; r -&gt; m (<a href="JsonApi-Internal-Document.html#t:Relationship">Relationship</a>, <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Monoid.html#t:Endo">Endo</a> <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a>)</li><li class="src short"><span class="keyword">class</span> <a href="#t:FetchAllRelationships">FetchAllRelationships</a> m r a <span class="keyword">where</span><ul class="subs"><li><a href="#v:fetchAllRelationships">fetchAllRelationships</a> :: <span class="keyword">forall</span> proxy. proxy a -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a> -&gt; r -&gt; m ([(<a href="file:///nix/store/wcg0nmsphmn7ig1j3602jznx2lxz91id-text-1.2.2.1/share/doc/x86_64-linux-ghc-7.10.3/text-1.2.2.1/html/Data-Text.html#t:Text">Text</a>, <a href="JsonApi-Internal-Document.html#t:Relationship">Relationship</a>)], <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Monoid.html#t:Endo">Endo</a> <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a>)</li></ul></li><li class="src short"><span class="keyword">class</span> <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="#t:SerialiseResource">SerialiseResource</a> m a <span class="keyword">where</span><ul class="subs"><li><span class="keyword">type</span> <a href="#t:SerialiseI">SerialiseI</a> m a</li><li><a href="#v:serialise">serialise</a> :: <span class="keyword">forall</span> proxy. proxy a -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:SerialiseI">SerialiseI</a> m a -&gt; m (<a href="JsonApi-Internal-Document.html#t:ResourceObject">ResourceObject</a>, <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Monoid.html#t:Endo">Endo</a> <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a>)</li></ul></li><li class="src short"><a href="#v:filterFields">filterFields</a> :: <a href="file:///nix/store/ala24qs3vbkxq3yg37x3lf52q48rria6-unordered-containers-0.2.7.0/share/doc/x86_64-linux-ghc-7.10.3/unordered-containers-0.2.7.0/html/Data-HashSet.html#t:HashSet">HashSet</a> <a href="file:///nix/store/wcg0nmsphmn7ig1j3602jznx2lxz91id-text-1.2.2.1/share/doc/x86_64-linux-ghc-7.10.3/text-1.2.2.1/html/Data-Text.html#t:Text">Text</a> -&gt; <a href="JsonApi-Internal-Document.html#t:ResourceObject">ResourceObject</a> -&gt; <a href="JsonApi-Internal-Document.html#t:ResourceObject">ResourceObject</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:FieldsFilter">FieldsFilter</a> = <a href="file:///nix/store/ala24qs3vbkxq3yg37x3lf52q48rria6-unordered-containers-0.2.7.0/share/doc/x86_64-linux-ghc-7.10.3/unordered-containers-0.2.7.0/html/Data-HashMap-Strict.html#t:HashMap">HashMap</a> <a href="JsonApi-Internal-Document.html#t:ResourceType">ResourceType</a> (<a href="file:///nix/store/ala24qs3vbkxq3yg37x3lf52q48rria6-unordered-containers-0.2.7.0/share/doc/x86_64-linux-ghc-7.10.3/unordered-containers-0.2.7.0/html/Data-HashSet.html#t:HashSet">HashSet</a> <a href="file:///nix/store/wcg0nmsphmn7ig1j3602jznx2lxz91id-text-1.2.2.1/share/doc/x86_64-linux-ghc-7.10.3/text-1.2.2.1/html/Data-Text.html#t:Text">Text</a>)</li><li class="src short"><a href="#v:serialiseDocument">serialiseDocument</a> :: <a href="JsonApi-Internal-Relationships.html#t:SerialiseResource">SerialiseResource</a> m a =&gt; proxy a -&gt; <a href="JsonApi-Internal-Document.html#t:ResourceData">ResourceData</a> (<a href="JsonApi-Internal-Relationships.html#t:SerialiseI">SerialiseI</a> m a) -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:FieldsFilter">FieldsFilter</a> -&gt; m <a href="JsonApi-Internal-Document.html#t:Document">Document</a></li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:FetchMode" class="def">FetchMode</a> <a href="src/JsonApi-Internal-Relationships.html#FetchMode" class="link">Source</a></p><div class="doc"><p>Describes if related resources should be fetcher, or we are interested
 in relationship itself only</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:FetchIncluded" class="def">FetchIncluded</a></td><td class="doc"><p>Fetch relationship with related resource</p></td></tr><tr><td class="src"><a name="v:FetchRelationship" class="def">FetchRelationship</a></td><td class="doc"><p>Fetch only relationship itself</p></td></tr></table></div><div class="subs instances"><p id="control.i:FetchMode" class="caption collapser" onclick="toggleSection('i:FetchMode')">Instances</p><div id="section.i:FetchMode" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> <a href="JsonApi-Internal-Relationships.html#t:FetchMode">FetchMode</a></span> <a href="src/JsonApi-Internal-Relationships.html#line-36" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Ord.html#t:Ord">Ord</a> <a href="JsonApi-Internal-Relationships.html#t:FetchMode">FetchMode</a></span> <a href="src/JsonApi-Internal-Relationships.html#line-36" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="JsonApi-Internal-Relationships.html#t:FetchMode">FetchMode</a></span> <a href="src/JsonApi-Internal-Relationships.html#line-36" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a name="t:FetchRelated" class="def">FetchRelated</a> m r nm a <span class="keyword">where</span> <a href="src/JsonApi-Internal-Relationships.html#FetchRelated" class="link">Source</a></p><div class="doc"><p>Class for fetching data for relationship <code>name</code>, from entity <code>r</code>
 to entity <code>a</code>.</p><p>In <code><a href="JsonApi-Internal-Relationships.html#t:FetchRelationship">FetchRelationship</a></code> mode, if you don't have any <code><a href="JsonApi-Internal-Document.html#t:ResourceId">ResourceId</a></code>s for
 related resources inferable just from source resource, you should
 return <code><a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Maybe.html#v:Nothing">Nothing</a></code> in <code>relationshipData</code> field.</p><p>In <code><a href="JsonApi-Internal-Relationships.html#v:FetchIncluded">FetchIncluded</a></code> mode, if you have returned any <code><a href="JsonApi-Internal-Document.html#t:ResourceId">ResourceId</a></code>s in
 <code>relationshipData</code> field, you must also return all resources whith same
 <code><a href="JsonApi-Internal-Document.html#t:ResourceId">ResourceId</a></code> in second field of result pair.</p><pre>instance Monad m =&gt; <code><a href="JsonApi-Internal-Relationships.html#t:FetchRelated">FetchRelated</a></code> Book &quot;author&quot; Author where
  fetchRelated _ mode book = case mode of
      <code><a href="JsonApi-Internal-Relationships.html#t:FetchRelationship">FetchRelationship</a></code> -&gt; pure (bookToAuthor, [])
      <code><a href="JsonApi-Internal-Relationships.html#v:FetchIncluded">FetchIncluded</a></code> -&gt; do
        author &lt;- fetchAuthor (bookAuthorId book)
        pure (bookToAuthor, [author])
     where
       bookToAuthor = <code><a href="JsonApi-Internal-Document.html#t:Relationship">Relationship</a></code>
         (links [(&quot;related&quot;, authorUrl (bookAuthorid book))]
         (Just $ <code><a href="JsonApi-Internal-Document.html#v:SingletonData">SingletonData</a></code> (bookAuthorId book))
         <code><a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Maybe.html#v:Nothing">Nothing</a></code>
</pre></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:fetchRelated" class="def">fetchRelated</a> <a href="src/JsonApi-Internal-Relationships.html#fetchRelated" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: proxy (<a href="JsonApi-Internal-Api.html#t:Rel">Rel</a> nm a)</td><td class="doc"><p>Relationship descriptor</p></td></tr><tr><td class="src">-&gt; <a href="JsonApi-Internal-Relationships.html#t:FetchMode">FetchMode</a></td><td class="doc"><p>Should associated resources be fetched</p></td></tr><tr><td class="src">-&gt; r</td><td class="doc"><p>base resource for this relationship</p></td></tr><tr><td class="src">-&gt; m (<a href="JsonApi-Internal-Document.html#t:Relationship">Relationship</a>, [a])</td><td class="doc"><p>Relationship and included objects, if requested.</p></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Include" class="def">Include</a> <a href="src/JsonApi-Internal-Relationships.html#Include" class="link">Source</a></p><div class="doc"><p>Describes what to do with related resources</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:IncludeDefault" class="def">IncludeDefault</a></td><td class="doc"><p>Only include those which are included by
 default, like specified with <code><a href="JsonApi-Internal-Api.html#t:RelInclude">RelInclude</a></code></p></td></tr><tr><td class="src"><a name="v:Include" class="def">Include</a></td><td class="doc"><p>Include this, but not kids</p></td></tr><tr><td class="src"><a name="v:IncludeNot" class="def">IncludeNot</a></td><td class="doc"><p>Do not include this</p></td></tr><tr><td class="src"><a name="v:IncludeChildren" class="def">IncludeChildren</a> (<a href="file:///nix/store/ala24qs3vbkxq3yg37x3lf52q48rria6-unordered-containers-0.2.7.0/share/doc/x86_64-linux-ghc-7.10.3/unordered-containers-0.2.7.0/html/Data-HashMap-Strict.html#t:HashMap">HashMap</a> <a href="file:///nix/store/wcg0nmsphmn7ig1j3602jznx2lxz91id-text-1.2.2.1/share/doc/x86_64-linux-ghc-7.10.3/text-1.2.2.1/html/Data-Text.html#t:Text">Text</a> <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a>)</td><td class="doc"><p>Include this and specified kids</p></td></tr></table></div><div class="subs instances"><p id="control.i:Include" class="caption collapser" onclick="toggleSection('i:Include')">Instances</p><div id="section.i:Include" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a></span> <a href="src/JsonApi-Internal-Relationships.html#line-81" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a></span> <a href="src/JsonApi-Internal-Relationships.html#line-81" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:includesForKid" class="def">includesForKid</a> :: <a href="file:///nix/store/wcg0nmsphmn7ig1j3602jznx2lxz91id-text-1.2.2.1/share/doc/x86_64-linux-ghc-7.10.3/text-1.2.2.1/html/Data-Text.html#t:Text">Text</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a> <a href="src/JsonApi-Internal-Relationships.html#includesForKid" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Included" class="def">Included</a> <a href="src/JsonApi-Internal-Relationships.html#Included" class="link">Source</a></p><div class="doc"><p>Resources to be included in top-level document</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Included" class="def">Included</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:includedIds" class="def">includedIds</a> :: !(<a href="file:///nix/store/ala24qs3vbkxq3yg37x3lf52q48rria6-unordered-containers-0.2.7.0/share/doc/x86_64-linux-ghc-7.10.3/unordered-containers-0.2.7.0/html/Data-HashSet.html#t:HashSet">HashSet</a> <a href="JsonApi-Internal-Document.html#t:ResourceId">ResourceId</a>)</dt><dd class="doc"><p>Ids of already included object</p></dd><dt class="src"><a name="v:includedObjects" class="def">includedObjects</a> :: <a href="file:///nix/store/ala24qs3vbkxq3yg37x3lf52q48rria6-unordered-containers-0.2.7.0/share/doc/x86_64-linux-ghc-7.10.3/unordered-containers-0.2.7.0/html/Data-HashMap-Strict.html#t:HashMap">HashMap</a> <a href="JsonApi-Internal-Document.html#t:ResourceType">ResourceType</a> [<a href="JsonApi-Internal-Document.html#t:ResourceObject">ResourceObject</a>]</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:Included" class="caption collapser" onclick="toggleSection('i:Included')">Instances</p><div id="section.i:Included" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a></span> <a href="src/JsonApi-Internal-Relationships.html#line-94" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:emptyIncluded" class="def">emptyIncluded</a> :: <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a> <a href="src/JsonApi-Internal-Relationships.html#emptyIncluded" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:addIncluded" class="def">addIncluded</a> :: <a href="JsonApi-Internal-Document.html#t:ResourceObject">ResourceObject</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a> <a href="src/JsonApi-Internal-Relationships.html#addIncluded" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:foldIncluded" class="def">foldIncluded</a> :: <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Foldable.html#t:Foldable">Foldable</a> t =&gt; t <a href="JsonApi-Internal-Document.html#t:ResourceObject">ResourceObject</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a> <a href="src/JsonApi-Internal-Relationships.html#foldIncluded" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">class</span> <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a name="t:FetchRelationship" class="def">FetchRelationship</a> m r a <span class="keyword">where</span> <a href="src/JsonApi-Internal-Relationships.html#FetchRelationship" class="link">Source</a></p><div class="doc"><p>fetches one of the specified relationships</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:fetchRelationship" class="def">fetchRelationship</a> :: <span class="keyword">forall</span> proxy. proxy a -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a> -&gt; r -&gt; m ((<a href="file:///nix/store/wcg0nmsphmn7ig1j3602jznx2lxz91id-text-1.2.2.1/share/doc/x86_64-linux-ghc-7.10.3/text-1.2.2.1/html/Data-Text.html#t:Text">Text</a>, <a href="JsonApi-Internal-Document.html#t:Relationship">Relationship</a>), <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Monoid.html#t:Endo">Endo</a> <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a>) <a href="src/JsonApi-Internal-Relationships.html#fetchRelationship" class="link">Source</a></p></div><div class="subs instances"><p id="control.i:FetchRelationship" class="caption collapser" onclick="toggleSection('i:FetchRelationship')">Instances</p><div id="section.i:FetchRelationship" class="show"><table><tr><td class="src clearfix"><span class="inst-left">(<a href="JsonApi-Internal-Resource.html#t:IsResource">IsResource</a> a, <a href="JsonApi-Internal-Resource.html#t:HasResourceId">HasResourceId</a> a, <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/GHC-TypeLits.html#t:KnownSymbol">KnownSymbol</a> nm, <a href="JsonApi-Internal-Relationships.html#t:FetchRelated">FetchRelated</a> m r nm a, (~) * related (<a href="JsonApi-Internal-Api.html#t:Resource">Resource</a> a relationships), <a href="JsonApi-Internal-Relationships.html#t:SerialiseResource">SerialiseResource</a> * m (<a href="JsonApi-Internal-Api.html#t:Resource">Resource</a> a relationships)) =&gt; <a href="JsonApi-Internal-Relationships.html#t:FetchRelationship">FetchRelationship</a> * m r (<a href="JsonApi-Internal-Api.html#t:RelInclude">RelInclude</a> nm (<a href="JsonApi-Internal-Api.html#t:Resource">Resource</a> a relationships))</span> <a href="src/JsonApi-Internal-Relationships.html#line-171" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="JsonApi-Internal-Resource.html#t:IsResource">IsResource</a> a, <a href="JsonApi-Internal-Resource.html#t:HasResourceId">HasResourceId</a> a, <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/GHC-TypeLits.html#t:KnownSymbol">KnownSymbol</a> nm, <a href="JsonApi-Internal-Relationships.html#t:FetchRelated">FetchRelated</a> m r nm a, (~) * related (<a href="JsonApi-Internal-Api.html#t:Resource">Resource</a> a relationships), <a href="JsonApi-Internal-Relationships.html#t:SerialiseResource">SerialiseResource</a> * m (<a href="JsonApi-Internal-Api.html#t:Resource">Resource</a> a relationships)) =&gt; <a href="JsonApi-Internal-Relationships.html#t:FetchRelationship">FetchRelationship</a> * m r (<a href="JsonApi-Internal-Api.html#t:Rel">Rel</a> nm (<a href="JsonApi-Internal-Api.html#t:Resource">Resource</a> a relationships))</span> <a href="src/JsonApi-Internal-Relationships.html#line-147" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:doFetchRelationship" class="def">doFetchRelationship</a> :: (<a href="JsonApi-Internal-Resource.html#t:IsResource">IsResource</a> a, <a href="JsonApi-Internal-Resource.html#t:HasResourceId">HasResourceId</a> a, <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/GHC-TypeLits.html#t:KnownSymbol">KnownSymbol</a> nm, <a href="JsonApi-Internal-Relationships.html#t:FetchRelated">FetchRelated</a> m r nm a, <a href="JsonApi-Internal-Relationships.html#t:SerialiseResource">SerialiseResource</a> m (<a href="JsonApi-Internal-Api.html#t:Resource">Resource</a> a relationships)) =&gt; <span class="keyword">forall</span> proxy. proxy (<a href="JsonApi-Internal-Api.html#t:Rel">Rel</a> nm a) -&gt; proxy (<a href="JsonApi-Internal-Api.html#t:Resource">Resource</a> a relationships) -&gt; <a href="JsonApi-Internal-Relationships.html#t:FetchMode">FetchMode</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a> -&gt; r -&gt; m (<a href="JsonApi-Internal-Document.html#t:Relationship">Relationship</a>, <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Monoid.html#t:Endo">Endo</a> <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a>) <a href="src/JsonApi-Internal-Relationships.html#doFetchRelationship" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">class</span> <a name="t:FetchAllRelationships" class="def">FetchAllRelationships</a> m r a <span class="keyword">where</span> <a href="src/JsonApi-Internal-Relationships.html#FetchAllRelationships" class="link">Source</a></p><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:fetchAllRelationships" class="def">fetchAllRelationships</a> :: <span class="keyword">forall</span> proxy. proxy a -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a> -&gt; r -&gt; m ([(<a href="file:///nix/store/wcg0nmsphmn7ig1j3602jznx2lxz91id-text-1.2.2.1/share/doc/x86_64-linux-ghc-7.10.3/text-1.2.2.1/html/Data-Text.html#t:Text">Text</a>, <a href="JsonApi-Internal-Document.html#t:Relationship">Relationship</a>)], <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Monoid.html#t:Endo">Endo</a> <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a>) <a href="src/JsonApi-Internal-Relationships.html#fetchAllRelationships" class="link">Source</a></p></div><div class="subs instances"><p id="control.i:FetchAllRelationships" class="caption collapser" onclick="toggleSection('i:FetchAllRelationships')">Instances</p><div id="section.i:FetchAllRelationships" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Control-Applicative.html#t:Applicative">Applicative</a> m =&gt; <a href="JsonApi-Internal-Relationships.html#t:FetchAllRelationships">FetchAllRelationships</a> [k] m r ([] k)</span> <a href="src/JsonApi-Internal-Relationships.html#line-201" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Control-Applicative.html#t:Applicative">Applicative</a> m, <a href="JsonApi-Internal-Relationships.html#t:FetchRelationship">FetchRelationship</a> k m r a, <a href="JsonApi-Internal-Relationships.html#t:FetchAllRelationships">FetchAllRelationships</a> [k] m r as) =&gt; <a href="JsonApi-Internal-Relationships.html#t:FetchAllRelationships">FetchAllRelationships</a> [k] m r ((:) k a as)</span> <a href="src/JsonApi-Internal-Relationships.html#line-204" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a name="t:SerialiseResource" class="def">SerialiseResource</a> m a <span class="keyword">where</span> <a href="src/JsonApi-Internal-Relationships.html#SerialiseResource" class="link">Source</a></p><div class="doc"><p>Fetches all related resources of some <code><a href="JsonApi-Internal-Api.html#t:Resource">Resource</a></code></p></div><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a name="t:SerialiseI" class="def">SerialiseI</a> m a <a href="src/JsonApi-Internal-Relationships.html#SerialiseI" class="link">Source</a></p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:serialise" class="def">serialise</a> :: <span class="keyword">forall</span> proxy. proxy a -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:SerialiseI">SerialiseI</a> m a -&gt; m (<a href="JsonApi-Internal-Document.html#t:ResourceObject">ResourceObject</a>, <a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Data-Monoid.html#t:Endo">Endo</a> <a href="JsonApi-Internal-Relationships.html#t:Included">Included</a>) <a href="src/JsonApi-Internal-Relationships.html#serialise" class="link">Source</a></p></div><div class="subs instances"><p id="control.i:SerialiseResource" class="caption collapser" onclick="toggleSection('i:SerialiseResource')">Instances</p><div id="section.i:SerialiseResource" class="show"><table><tr><td class="src clearfix"><span class="inst-left">(<a href="file:///nix/store/vz7qfnmi0qg4jrc7j9l5i1izq64aaci8-ghc-7.10.3/share/doc/ghc/html/libraries/base-4.8.2.0/Control-Monad.html#t:Monad">Monad</a> m, <a href="JsonApi-Internal-Resource.html#t:IsResource">IsResource</a> a, <a href="JsonApi-Internal-Relationships.html#t:FetchAllRelationships">FetchAllRelationships</a> [*] m a relationships) =&gt; <a href="JsonApi-Internal-Relationships.html#t:SerialiseResource">SerialiseResource</a> * m (<a href="JsonApi-Internal-Api.html#t:Resource">Resource</a> a relationships)</span> <a href="src/JsonApi-Internal-Relationships.html#line-223" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:filterFields" class="def">filterFields</a> :: <a href="file:///nix/store/ala24qs3vbkxq3yg37x3lf52q48rria6-unordered-containers-0.2.7.0/share/doc/x86_64-linux-ghc-7.10.3/unordered-containers-0.2.7.0/html/Data-HashSet.html#t:HashSet">HashSet</a> <a href="file:///nix/store/wcg0nmsphmn7ig1j3602jznx2lxz91id-text-1.2.2.1/share/doc/x86_64-linux-ghc-7.10.3/text-1.2.2.1/html/Data-Text.html#t:Text">Text</a> -&gt; <a href="JsonApi-Internal-Document.html#t:ResourceObject">ResourceObject</a> -&gt; <a href="JsonApi-Internal-Document.html#t:ResourceObject">ResourceObject</a> <a href="src/JsonApi-Internal-Relationships.html#filterFields" class="link">Source</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:FieldsFilter" class="def">FieldsFilter</a> = <a href="file:///nix/store/ala24qs3vbkxq3yg37x3lf52q48rria6-unordered-containers-0.2.7.0/share/doc/x86_64-linux-ghc-7.10.3/unordered-containers-0.2.7.0/html/Data-HashMap-Strict.html#t:HashMap">HashMap</a> <a href="JsonApi-Internal-Document.html#t:ResourceType">ResourceType</a> (<a href="file:///nix/store/ala24qs3vbkxq3yg37x3lf52q48rria6-unordered-containers-0.2.7.0/share/doc/x86_64-linux-ghc-7.10.3/unordered-containers-0.2.7.0/html/Data-HashSet.html#t:HashSet">HashSet</a> <a href="file:///nix/store/wcg0nmsphmn7ig1j3602jznx2lxz91id-text-1.2.2.1/share/doc/x86_64-linux-ghc-7.10.3/text-1.2.2.1/html/Data-Text.html#t:Text">Text</a>) <a href="src/JsonApi-Internal-Relationships.html#FieldsFilter" class="link">Source</a></p><div class="doc"><p>Which fields to include in output by <code><a href="JsonApi-Internal-Document.html#t:ResourceType">ResourceType</a></code>
 used for sparse fieldsets functionality.</p><p><a href="http://jsonapi.org/format/#fetching-sparse-fieldsets">JSON API Spec</a></p></div></div><div class="top"><p class="src"><a name="v:serialiseDocument" class="def">serialiseDocument</a> :: <a href="JsonApi-Internal-Relationships.html#t:SerialiseResource">SerialiseResource</a> m a =&gt; proxy a -&gt; <a href="JsonApi-Internal-Document.html#t:ResourceData">ResourceData</a> (<a href="JsonApi-Internal-Relationships.html#t:SerialiseI">SerialiseI</a> m a) -&gt; <a href="JsonApi-Internal-Relationships.html#t:Include">Include</a> -&gt; <a href="JsonApi-Internal-Relationships.html#t:FieldsFilter">FieldsFilter</a> -&gt; m <a href="JsonApi-Internal-Document.html#t:Document">Document</a> <a href="src/JsonApi-Internal-Relationships.html#serialiseDocument" class="link">Source</a></p><div class="doc"><p>serialise resource <code>a</code> associated with type <code>'SerialiseI m a'</code>
 into a document. You can add links and meta to that document later</p><pre>type BookResource = Resource Book '[Rel &quot;author&quot; (Resource Author '[])]

getBookResource :: BookId -&gt; Document
getBookResource bookId = withTransaction $ do
  book &lt;- getBook bookId
  <code><a href="JsonApi-Internal-Relationships.html#v:serialiseDocument">serialiseDocument</a></code> (Proxy :: Proxy BookResource)
                     (<code><a href="JsonApi-Internal-Document.html#v:SingletonData">SingletonData</a></code> book)
                     <code><a href="JsonApi-Internal-Relationships.html#v:IncludeDefault">IncludeDefault</a></code>
                     mempty

</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>